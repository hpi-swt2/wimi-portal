<%- model_class = Project -%>
<div class="page-header">
  <h1><%=t '.title', default: model_class.model_name.human.titleize %> #<%= @project.id %>: <%= @project.title %> <span> <%= @project.status ? '' : t('.inactive', default:'(inactive)') %></span></h1>
  <% if can? :edit, @project%>
      <% if @project.status%>
          <%= button_to t('.set_inactive', default: 'set inactive'), toggle_status_project_path, method: :get, class: 'btn btn-danger btn-xs pull-right', style:'margin-top: -20px', id: 'setInactiveButton' %>
      <% else %>
          <%= button_to t('.set_active', default: 'set active'), toggle_status_project_path, method: :get, class: 'btn btn-success btn-xs pull-right', style:'margin-top: -20px'%>
      <% end %>
  <% end %>
</div>

<dl class="dl-horizontal">
  <dt><%= t('.chair', default:'Chair') %>:</dt>
  <dd><%= @project.chair.name %></dd>
  <dt><%= t('.chair_representative', default: 'Chair Representative') %>:</dt>
  <dd><%= @project.chair.representative.user.name %></dd>
  <dt><%= t('.project_visibility', default:'Visibility') %>:</dt>
  <dd><%= @project.public ? t('.public', default:'Public') : t('.private', default:'private') %></dd>
  <dt><%= t('.project_leader', default: 'Project Leader') %>:</dt>
  <dd>
    <%if @project.project_leader.blank? %>
        <i><%= t('.not_defined', default:'not defined') %></i>
    <% else %>
        <%= @project.project_leader %></dd>
    <% end %>
    </dl>

<dl class="dl-horizontal">
  <dt><strong><%= t('.research_assistants', default:'Research Assistants') %>:</strong> </dt>
  <dd>
    <% @project.users.sort { |a,b| a.name <=> b.name }.each do |user| %>
        <div <%= "class='current'" if user == @user%>>
          <% if user.is_wimi?%>
              <div style="margin-bottom: 15px">
                <%= user.name %>
              </div>
          <% end %>
        </div>
    <% end %>
  </dd>
</dl>
<dl class="dl-horizontal">
  <dt><strong><%= t('.student_assistants', default:'Student Assistants') %>:</strong> </dt>
  <dd>
    <% @project.users.sort { |a,b| a.name <=> b.name }.each do |user| %>
        <div <%= "class='current'" if user == @user %>>
          <% if user.is_hiwi?%>
              <div style="margin-bottom: 15px">
                <%= user.name %>
                <%= link_to t('projects.form.show_working_hours', default:'Show working hours'), work_days_path(month: 1, year: 2016, project: @project.id), class: 'btn btn-warning btn-xs' %>
              </div>
          <% end %>
        </div>
    <% end %>
  </dd>


</dl>

<% content_for :modals do %>
    <%= render 'invite_user' %>
<% end %>

<% if can?(:invite_user, @project) %>
    <%= link_to t('project.invite_someone_to_project'), "", id: "open-popup", data: { toggle: "modal", target: "#invite-colleagues-modal" }, class: "btn btn-default pull-right" %>
<% end %>

<% if current_user.is_hiwi? %>
    <div>

    </div>
    <%= link_to t('.leave_project', default: t("helpers.links.leave")),
                remove_user_project_path(id: @project, user_id: current_user.id),
                method: 'get',
                data: { confirm: t('.confirm', default: t("helpers.links.confirm", default: 'Are you sure?')) },
                class: 'btn btn-danger' %>
<% end %>

<%= link_to t('.back', default: t("helpers.links.back")),
            projects_path, class: 'btn btn-default'  %>
<% if can? :edit, @project %>
    <%= link_to t('.edit', default: t("helpers.links.edit")),
                edit_project_path(@project), class: 'btn btn-default' %>
<% end %>
<% if @project.users.include? current_user%>
    <%= link_to t('.leave_project', default:'Leave Project'),
                sign_user_out_project_path(user_id: current_user.id, id: @project), method: :delete, class: 'btn btn-default' %>
<% end %>

<% if can? :destroy, @project %>
    <%= link_to t('.destroy', default: t("helpers.links.destroy")),
                project_path(@project),
                method: 'delete',
                data: { confirm: t('.confirm', default: t("helpers.links.confirm", default: 'Are you sure?')) },
                class: 'btn btn-danger' %>
<% end %>
<% if can? :edit, @project %>
    <%= link_to t('projects.form.show_all_working_hours', default:'Show all working hours'),
                work_days_path(month: 1, year: 2016, project: @project.id), class: 'btn btn-default pull-right', style: 'margin-right: 15px' %>
<% end %>




